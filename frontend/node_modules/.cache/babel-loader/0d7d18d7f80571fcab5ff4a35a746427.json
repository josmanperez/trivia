{"ast":null,"code":"import _regeneratorRuntime from\"/Users/josman.perez/Documents/Development/Web/trivia-flexible/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/josman.perez/Documents/Development/Web/trivia-flexible/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/josman.perez/Documents/Development/Web/trivia-flexible/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import*as Realm from\"realm-web\";import{app,client}from\"../index\";import{Navbar,Nav,Button,Form,FormControl}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function LoginFields(props){var loggedIn=props.loggedIn,setLoggedIn=props.setLoggedIn;var setShowRanking=props.setShowRanking;var setShowLastGame=props.setShowLastGame;var _React$useState=React.useState(app.currentUser?app.currentUser.profile.email:\"\"),_React$useState2=_slicedToArray(_React$useState,2),username=_React$useState2[0],setUsername=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),password=_React$useState4[0],setPassword=_React$useState4[1];// Handle login\nfunction handleLogin(_x){return _handleLogin.apply(this,arguments);}// Handle logout\nfunction _handleLogin(){_handleLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var user,_user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;event.preventDefault();_context.next=4;return app.logIn(Realm.Credentials.emailPassword(username,password));case 4:user=_context.sent;console.log(\"Successfully email/password logged in!\",user.id);setLoggedIn(app.currentUser?true:false);_context.next=9;return client.clearStore();case 9:_context.next=11;return client.resetStore();case 11:_context.next=33;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);_context.prev=15;_context.next=18;return app.emailPasswordAuth.registerUser(username,password);case 18:_context.next=20;return app.logIn(Realm.Credentials.emailPassword(username,password));case 20:_user=_context.sent;console.log(\"Successfully email/password logged in!\",_user.id);setLoggedIn(app.currentUser?true:false);_context.next=25;return client.clearStore();case 25:_context.next=27;return client.resetStore();case 27:_context.next=33;break;case 29:_context.prev=29;_context.t1=_context[\"catch\"](15);console.error(\"Failed to log in\",_context.t1.message);alert(\"Ops!, \".concat(_context.t1.error));case 33:case\"end\":return _context.stop();}}},_callee,null,[[0,13],[15,29]]);}));return _handleLogin.apply(this,arguments);}function handleLogout(){return _handleLogout.apply(this,arguments);}function _handleLogout(){_handleLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;user=app.currentUser;if(!(user.id===app.currentUser.id)){_context2.next=6;break;}app.currentUser.logOut();_context2.next=6;return app.removeUser(user);case 6:setLoggedIn(app.currentUser?true:false);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.error(\"Failed to logout\",_context2.t0.message);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return _handleLogout.apply(this,arguments);}function validateForm(){return username.length>0&&password.length>0;}return/*#__PURE__*/_jsxs(Navbar,{bg:\"dark\",expand:\"lg\",variant:\"dark\",children:[/*#__PURE__*/_jsx(Navbar.Brand,{href:\"#home\",children:loggedIn?\"Signed in as: \".concat(username):\"Please, Login or Register\"}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"navbarScroll\"}),/*#__PURE__*/_jsxs(Navbar.Collapse,{className:\"justify-content-start\",children:[/*#__PURE__*/_jsxs(Nav,{className:\"mr-auto\",children:[/*#__PURE__*/_jsx(Nav.Link,{children:loggedIn&&/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setShowRanking(true);},variant:\"secondary\",disabled:!loggedIn,children:\"Ranking\"})}),/*#__PURE__*/_jsx(Nav.Link,{children:loggedIn&&/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setShowLastGame(true);},variant:\"secondary\",disabled:!loggedIn,children:\"Game Stats\"})})]}),/*#__PURE__*/_jsxs(Form,{className:\"d-flex\",inline:true,onSubmit:handleLogin,children:[/*#__PURE__*/_jsx(FormControl,{type:\"text\",placeholder:\"Enter email\",className:\"mr-sm-2\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(FormControl,{type:\"password\",placeholder:\"Password\",className:\"mr-sm-2\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),loggedIn?/*#__PURE__*/_jsx(Button,{onClick:handleLogout,variant:\"secondary\",children:\"Logout\"}):/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"success\",disabled:!validateForm(),children:\"Login/Register\"})]})]})]});}","map":{"version":3,"names":["React","Realm","app","client","Navbar","Nav","Button","Form","FormControl","LoginFields","props","loggedIn","setLoggedIn","setShowRanking","setShowLastGame","useState","currentUser","profile","email","username","setUsername","password","setPassword","handleLogin","event","preventDefault","logIn","Credentials","emailPassword","user","console","log","id","clearStore","resetStore","emailPasswordAuth","registerUser","error","message","alert","handleLogout","logOut","removeUser","validateForm","length","e","target","value"],"sources":["/Users/josman.perez/Documents/Development/Web/trivia-flexible/src/components/LoginFields.js"],"sourcesContent":["import React from \"react\";\nimport * as Realm from \"realm-web\";\nimport {\n  app,\n  client\n} from \"../index\";\nimport {\n  Navbar,\n  Nav,\n  Button,\n  Form,\n  FormControl\n} from \"react-bootstrap\";\n\nexport default function LoginFields(props) {\n\n  const { loggedIn, setLoggedIn } = props;\n  const { setShowRanking } = props;\n  const { setShowLastGame } = props;\n\n  const [username, setUsername] = React.useState(\n    app.currentUser ? app.currentUser.profile.email : \"\"\n  );\n  const [password, setPassword] = React.useState(\"\");\n\n  // Handle login\n  async function handleLogin(event) {\n    try {\n      event.preventDefault();\n      const user = await app.logIn(Realm.Credentials.emailPassword(username, password));\n      console.log(\"Successfully email/password logged in!\", user.id);\n      setLoggedIn(\n        app.currentUser ? true : false\n      );\n      await client.clearStore()\n      await client.resetStore()\n    } catch (err) {\n      try {\n        await app.emailPasswordAuth.registerUser(username, password);\n        const user = await app.logIn(Realm.Credentials.emailPassword(username, password));\n        console.log(\"Successfully email/password logged in!\", user.id);\n        setLoggedIn(\n          app.currentUser ? true : false\n        );\n        await client.clearStore()\n        await client.resetStore()\n      } catch (error) {\n        console.error(\"Failed to log in\", error.message);\n        alert(`Ops!, ${error.error}`);\n      }\n    }\n  }\n\n  // Handle logout\n  async function handleLogout() {\n    try {\n      const user = app.currentUser;\n      if (user.id === app.currentUser.id) {\n        app.currentUser.logOut();\n        await app.removeUser(user);\n      }\n      setLoggedIn(\n        app.currentUser ? true : false\n      );\n    } catch (err) {\n      console.error(\"Failed to logout\", err.message);\n    }\n  }\n\n  function validateForm() {\n    return username.length > 0 && password.length > 0;\n  }\n\n  return (\n    <Navbar bg=\"dark\" expand=\"lg\" variant=\"dark\">\n      <Navbar.Brand href=\"#home\">\n        {loggedIn ? (`Signed in as: ${username}`) : (\"Please, Login or Register\")}\n      </Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"navbarScroll\" />\n      <Navbar.Collapse className=\"justify-content-start\">\n        <Nav className=\"mr-auto\">\n          <Nav.Link>\n            {loggedIn &&\n              <Button\n                onClick={() => setShowRanking(true)}\n                variant=\"secondary\"\n                disabled={!loggedIn}>Ranking\n              </Button>\n            }\n          </Nav.Link>\n          <Nav.Link>\n            {loggedIn &&\n              <Button\n                onClick={() => setShowLastGame(true)}\n                variant=\"secondary\"\n                disabled={!loggedIn}>Game Stats\n              </Button>\n            }\n          </Nav.Link>\n        </Nav>\n        <Form className=\"d-flex\" inline onSubmit={handleLogin}>\n          <FormControl\n            type=\"text\"\n            placeholder=\"Enter email\"\n            className=\"mr-sm-2\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)} />\n          <FormControl\n            type=\"password\"\n            placeholder=\"Password\"\n            className=\"mr-sm-2\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)} />\n          {loggedIn ?\n            (<Button onClick={handleLogout} variant=\"secondary\">Logout</Button>) :\n            (<Button type=\"submit\" variant=\"success\" disabled={!validateForm()}>Login/Register</Button>)}\n        </Form>\n      </Navbar.Collapse>\n    </Navbar>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}